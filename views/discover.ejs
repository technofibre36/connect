<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Discover — InvestConnect</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:linear-gradient(180deg,#071028 0%,#071733 60%);color:#e6eef8}
    header{display:flex;align-items:center;justify-content:space-between;padding:20px 32px;border-bottom:1px solid rgba(255,255,255,0.03)}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#12b886,#0ea5a4);display:flex;align-items:center;justify-content:center;font-weight:700}
    .nav a{color:rgba(230,238,248,0.9);text-decoration:none;margin-left:18px}
    .container{max-width:1200px;margin:28px auto;padding:0 20px;display:grid;grid-template-columns:1fr 360px;gap:20px}
    .panel{background:rgba(255,255,255,0.02);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .search{display:flex;gap:8px}
    .input{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .btn{background:#12b886;color:#042028;padding:10px 14px;border-radius:8px;border:none;cursor:pointer}
    .list{display:flex;flex-direction:column;gap:12px;margin-top:12px}
    .card{padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);display:flex;justify-content:space-between;align-items:center}
    .muted{color:#9aa6bd}
    .tabs{display:flex;gap:8px}
    .tab{padding:8px 12px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);cursor:pointer}
    .tab.active{background:rgba(255,255,255,0.03)}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">IC</div>
      <div>
        <div style="font-weight:700">InvestConnect</div>
        <div class="muted" style="font-size:12px">Find investors or startups</div>
      </div>
    </div>
    <nav class="nav">
      <a href="/">Home</a>
      <a href="/dashboard">Dashboard</a>
      <a href="/discover">Discover</a>
      <a href="/logout">Logout</a>
    </nav>
  </header>

  <main class="container">
    <section class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h2 style="margin:0">Discover</h2>
        <div class="tabs">
          <div class="tab active" id="tabInvestors" onclick="show('investors')">Find Investors</div>
          <div class="tab" id="tabStartups" onclick="show('startups')">Find Startups</div>
        </div>
      </div>

      <div style="margin-top:12px" id="searchArea">
        <div class="search">
          <input class="input" id="q" placeholder="Search by name, industry, tag..." />
          <button class="btn" id="searchBtn">Search</button>
        </div>

        <div style="margin-top:8px">
          <button class="tab" id="seedBtn" onclick="seedSample()">Seed sample data</button>
        </div>

        <div class="list" id="results">
          <!-- results populated by JS -->
        </div>
      </div>
    </section>

    <aside class="panel">
      <h4 style="margin-top:0">Filters</h4>
      <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
        <label class="muted">Location</label>
        <select class="input">
          <option>Any</option>
          <option>North America</option>
          <option>Europe</option>
          <option>Asia</option>
        </select>

        <label class="muted">Investment Stage</label>
        <select class="input">
          <option>Any</option>
          <option>Pre-seed</option>
          <option>Seed</option>
          <option>Series A+</option>
        </select>

        <label class="muted">Industry</label>
        <input class="input" placeholder="e.g. fintech, healthcare" />
      </div>
    </aside>
  </main>

    <script>
      let mode = 'investors';
      document.getElementById('tabInvestors').addEventListener('click', ()=>setMode('investors'));
      document.getElementById('tabStartups').addEventListener('click', ()=>setMode('startups'));
      document.getElementById('searchBtn').addEventListener('click', ()=>doSearch());

      function setMode(m){
        mode = m;
        document.getElementById('tabInvestors').classList.toggle('active', m==='investors');
        document.getElementById('tabStartups').classList.toggle('active', m==='startups');
        doSearch();
      }

      async function doSearch(){
        const q = document.getElementById('q').value.trim();
        const url = mode==='investors' ? '/api/investors' : '/api/startups';
        const res = await fetch(url + (q?('?q='+encodeURIComponent(q)):'') );
        if(!res.ok){alert('Search failed');return}
        const data = await res.json();
        renderResults(data);
      }

      function renderResults(items){
        const out = document.getElementById('results');
        out.innerHTML = '';
        if(!items || items.length===0){ out.innerHTML = '<div class="muted">No results</div>'; return }
        items.forEach(i=>{
          const div = document.createElement('div');
          div.className='card';
          const title = i.name || i.tagline || 'Untitled';
          const subtitle = i.bio || i.tagline || (i.industry || i.industries && i.industries.join(', ')) || '';
          div.innerHTML = `<div><div style="font-weight:700">${escapeHtml(title)}</div><div class="muted">${escapeHtml(subtitle)}</div></div><div style="text-align:right"><button class="btn" onclick="onAction('${escapeHtml(title)}')">View</button></div>`;
          out.appendChild(div);
        })
      }

      function onAction(name){ alert('Open profile: '+name) }

      async function seedSample(){
        // create a couple of sample investors and startups
        await fetch('/api/investors',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({name:'Asha Kumar',bio:'Syndicate lead — consumer',industries:['consumer'],location:'India'})});
        await fetch('/api/investors',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({name:'Blue Harbor Capital',bio:'VC firm — B2B SaaS',industries:['saas'],location:'US'})});
        await fetch('/api/startups',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({name:'NeatPay',tagline:'Fintech — payments API',industry:'fintech',stage:'seed'})});
        await fetch('/api/startups',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({name:'GreenLoop',tagline:'Climate tech — recycling',industry:'climate',stage:'pre-seed'})});
        alert('Seeded sample data');
        doSearch();
      }

      function escapeHtml(unsafe){return String(unsafe||'').replace(/[&<>"']/g,function(m){return{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#039;"}[m]});}

      // initial
      doSearch();
    </script>
</body>
</html>
